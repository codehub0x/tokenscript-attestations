<html>
<head>
    <style>
        #log div {
            margin-bottom: 5px;
            background-color: #f5f5f5;
            padding: 5px 10px;
            white-space: normal;
            word-break: break-word;
        }
    </style>
</head>
<body>
<div id="log"></div>
    <script type="text/javascript" src="dist/bundle.js"></script>
<script>
    counter = 1;
    function writeToLog(text){
        let node = document.createElement('div');
        node.innerText = counter + ". " + text;
        log.prepend(node);
        counter++;
    }

    function uint8tohex(uint8) {
        return Array.from(uint8).map(i => ('0' + i.toString(16)).slice(-2)).join('');
    }

    function base64ToUint8array( base64str ) {
        if (typeof Buffer !== 'undefined') {
            return Uint8Array.from(Buffer.from(base64str, 'base64'));
        } else {
            return Uint8Array.from(atob(base64str), c => c.charCodeAt(0));
        }
    }

    (async ()=>{
        // valid:
        // GeneralizedTime 2021-01-15 01:10:46 UTC
        // GeneralizedTime 2021-01-19 05:10:46 UTC
        let base64cheque = "MIH5MGoCASowIhgPMjAyMTAxMTUwMTEwNDZaGA8yMDIxMDExOTA1MTA0NloEQQQSnR7y9zi7AYpYKwwpGeGgnPyRkZXO3gUG65BMRPqkexa1hfAItIA/1qT93wvWV5Qzn7DKDOR8Boew+Db4mNAwA0IABNE5siahpFnMb/iCfYlzhJo6w1kTZi+hiDPimEPEu9j+jV57cATcJm+BYzAdHnAQB+NuiLgqbRv58F5CgxXGlnIDRwAwRAIgCcsTh0ZlLeLwEuvTJdQKPHuF92KvzeT1IQlXvmH4gFMCIB767eFUwPcPUI//9zS3ulT0WZVTPK7r+6DUO2twJdNs";

        let base64chequeSecret ="MCIEICyvhQsLNYHlCrN1isS66HcSG0zSlW7pGi0OtH6y+AGE";

        let chequeSecret = BigInt('0x'+ uint8tohex(base64ToUint8array(base64chequeSecret)));
        // let attestationSecret = BigInt('0x'+ uint8tohex(base64ToUint8array(base64attestationSecret)));

        writeToLog('base64cheque: ' + base64cheque);
        writeToLog('base64chequeSecret: ' + chequeSecret);

        (new Authenticator()).getAuthenticationBlob({
            ticketBlob: base64cheque,
            ticketSecret: chequeSecret,
            // attestationOrigin: 'https://stage.attestation.id/outlet',
            attestationOrigin: 'attestation.id.html',
        }, useDevconTicket => {
            writeToLog('useDevconTicket received (in hex ): ' + useDevconTicket);
        });

    })()

</script>
</body>
</html>
